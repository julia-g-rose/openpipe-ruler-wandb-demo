# Training configuration for email search agent
# This file defines all hyperparameters and settings for the training run

# Model configuration
project: "email-agent-openpipe-weave-models-demo"
model_name_ruler: "qwen-art-trainable-model-email-agent-v4"  # For RULER training
model_name_independent: "qwen-art-trainable-model-email-agent-independent"  # For independent reward training
model_name_combined: "qwen-art-trainable-model-email-agent-combined"  # For combined RULER + independent rewards
base_model: "OpenPipe/Qwen3-14B-Instruct"

# Dataset configuration
training_dataset_size: 500  # Number of training scenarios to load (increased for better training)
validation_dataset_size: 100  # Number of validation scenarios to load
dataset_seed: 42  # Random seed for dataset shuffling

# Dataset artifacts
training_dataset_artifact: "enron-training-scenarios:latest"
validation_dataset_artifact: "enron-validation-scenarios:latest"

# Judge models
ruler_judge_model: "openai/gpt-5"  # Used by RULER for scoring trajectories during training
correctness_judge_model: "openai/gpt-5"  # Used for evaluating answer correctness
tool_judge_model: "openai/gpt-5"  # Used for evaluating tool call appropriateness

# Comparison models (for compare_models.py)
comparison_model: "gpt-5"  # Second model for leaderboard comparison

# Training hyperparameters
groups_per_step: 4  # Increased from 2 for more scenarios per update
num_epochs: 1 
rollouts_per_group: 4  # Balanced for RULER signal vs API reliability
learning_rate: 5.0e-6  # Decreased from 1.0e-5 for more stable updates

# Validation and evaluation
validation_step_interval: 25  # Decreased from 25 for more frequent validation
log_correctness_correlation_plots: true  # Log correlation plots comparing correct vs incorrect predictions

# Timeout settings (in seconds) to prevent hanging
rollout_timeout: 600  # 10 minutes max per rollout
inference_timeout: 300  # 5 minutes max per model inference call
scorer_timeout: 60  # 60 seconds max per scorer call

# Checkpointing
save_checkpoint_artifact: true  # Save checkpoints as W&B artifacts

# Reproducibility
random_seed: 42

# W&B run configuration
wandb_job_type: "train"

